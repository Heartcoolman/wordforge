import{q as m,b as w,o as N,f as V,i as r,c as n,S as p,C as A,e as R,w as y,F as W,m as F,d as q,t as c,n as G,s as O}from"./index-6s_4JTtF.js";import{P as D}from"./Progress-DU77zIq3.js";import{usersApi as H}from"./users-Bw0aJsUF.js";import{r as U}from"./records-C70kufFG.js";import{a as I}from"./amas-D0E_g4bX.js";import{f as B,a as J}from"./formatters-DIeyM1Gq.js";const K={get(l){return m.get(`/api/word-states/${l}`)},batchGet(l){return m.post("/api/word-states/batch",{wordIds:l})},getDueList(l=50){return m.get("/api/word-states/due/list",{limit:l})},getOverview(){return m.get("/api/word-states/stats/overview")},batchUpdate(l){return m.post("/api/word-states/batch-update",l)},markMastered(l){return m.post(`/api/word-states/${l}/mark-mastered`)},reset(l){return m.post(`/api/word-states/${l}/reset`)}};var Q=c('<h2 class="text-lg font-semibold text-content mb-4">每日学习'),T=c("<div class=space-y-2>"),X=c('<div class="space-y-6 animate-fade-in-up"><h1 class="text-2xl font-bold text-content">学习统计'),Y=c('<div class="flex justify-center py-12">'),L=c('<div class="grid grid-cols-2 md:grid-cols-4 gap-4">'),Z=c('<h2 class="text-lg font-semibold text-content mb-4">单词状态分布'),tt=c('<div class="grid grid-cols-4 gap-4 mb-4"><div class=text-center><p class="text-xl font-bold text-content-tertiary"></p><p class="text-xs text-content-secondary">新单词</p></div><div class=text-center><p class="text-xl font-bold text-info"></p><p class="text-xs text-content-secondary">学习中</p></div><div class=text-center><p class="text-xl font-bold text-warning"></p><p class="text-xs text-content-secondary">复习中</p></div><div class=text-center><p class="text-xl font-bold text-success"></p><p class="text-xs text-content-secondary">已掌握'),et=c('<div class="flex rounded-full overflow-hidden h-3"><div class=bg-surface-tertiary></div><div class=bg-info></div><div class=bg-warning></div><div class=bg-success>'),rt=c('<h2 class="text-lg font-semibold text-content mb-4">认知状态'),lt=c('<p class="text-xs text-content-tertiary mt-3">总事件数: <!> | 会话事件: '),nt=c('<div class="flex items-center gap-3 text-sm"><span class="w-20 text-content-secondary text-xs"></span><div class=flex-1></div><span class="w-12 text-right text-xs text-content-tertiary"> 题</span><span class="w-12 text-right text-xs text-content-tertiary">%'),at=c('<div class="flex items-center gap-3"><div><svg fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round></path></svg></div><div><p class="text-xl font-bold text-content"></p><p class="text-xs text-content-secondary">'),st=c('<div><div class="flex justify-between text-xs mb-1"><span class=text-content-secondary></span><span class=text-content>%');function vt(){const[l,v]=w(null),[u,x]=w(null),[g,h]=w(null),[z,P]=w(null),[S,E]=w(!0);return N(async()=>{try{const[a,t,e,s]=await Promise.allSettled([H.getStats(),U.enhancedStatistics(),I.getState(),K.getOverview()]);a.status==="fulfilled"&&v(a.value),t.status==="fulfilled"&&x(t.value),e.status==="fulfilled"&&h(e.value),s.status==="fulfilled"&&P(s.value)}catch(a){V.toast.error("加载统计失败",a instanceof Error?a.message:"")}finally{E(!1)}}),(()=>{var a=X();return a.firstChild,r(a,n(p,{get when(){return!S()},get fallback(){return(()=>{var t=Y();return r(t,n(q,{size:"lg"})),t})()},get children(){return[n(p,{get when(){return l()},children:t=>(()=>{var e=L();return r(e,n(M,{label:"学习单词",get value(){return B(t().totalWordsLearned)},icon:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253",color:"accent"}),null),r(e,n(M,{label:"总记录数",get value(){return B(t().totalRecords)},icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",color:"info"}),null),r(e,n(M,{label:"连续天数",get value(){return`${t().streakDays} 天`},icon:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z",color:"warning"}),null),r(e,n(M,{label:"正确率",get value(){return J(t().accuracyRate)},icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",color:"success"}),null),e})()}),n(p,{get when(){return z()},children:t=>{const e=()=>t().new+t().learning+t().reviewing+t().mastered;return n(A,{variant:"elevated",get children(){return[Z(),(()=>{var s=tt(),o=s.firstChild,f=o.firstChild,d=o.nextSibling,_=d.firstChild,i=d.nextSibling,b=i.firstChild,$=i.nextSibling,C=$.firstChild;return r(f,()=>t().new),r(_,()=>t().learning),r(b,()=>t().reviewing),r(C,()=>t().mastered),s})(),n(p,{get when(){return e()>0},get children(){var s=et(),o=s.firstChild,f=o.nextSibling,d=f.nextSibling,_=d.nextSibling;return R(i=>{var b=`${t().new/e()*100}%`,$=`${t().learning/e()*100}%`,C=`${t().reviewing/e()*100}%`,j=`${t().mastered/e()*100}%`;return b!==i.e&&y(o,"width",i.e=b),$!==i.t&&y(f,"width",i.t=$),C!==i.a&&y(d,"width",i.a=C),j!==i.o&&y(_,"width",i.o=j),i},{e:void 0,t:void 0,a:void 0,o:void 0}),s}})]}})}}),n(p,{get when(){return g()},children:t=>n(A,{variant:"elevated",get children(){return[rt(),(()=>{var e=L();return r(e,n(k,{label:"注意力",get value(){return t().attention},color:"accent"}),null),r(e,n(k,{label:"疲劳度",get value(){return t().fatigue},color:"error"}),null),r(e,n(k,{label:"动机",get value(){return t().motivation},color:"success"}),null),r(e,n(k,{label:"信心",get value(){return t().confidence},color:"info"}),null),e})(),(()=>{var e=lt(),s=e.firstChild,o=s.nextSibling;return o.nextSibling,r(e,()=>t().totalEventCount,o),r(e,()=>t().sessionEventCount,null),e})()]}})}),n(p,{get when(){return F(()=>!!u()?.daily)()&&u().daily.length>0},get children(){return n(A,{variant:"elevated",get children(){return[Q(),(()=>{var t=T();return r(t,n(W,{get each(){return u().daily.slice(-14)},children:e=>(()=>{var s=nt(),o=s.firstChild,f=o.nextSibling,d=f.nextSibling,_=d.firstChild,i=d.nextSibling,b=i.firstChild;return r(o,()=>e.date),r(f,n(D,{get value(){return e.total},get max(){return Math.max(...u().daily.map($=>$.total),1)},size:"sm",get color(){return F(()=>e.accuracy>.8)()?"success":e.accuracy>.5?"warning":"error"}})),r(d,()=>e.total,_),r(i,()=>(e.accuracy*100).toFixed(0),b),s})()})),t})()]}})}})]}}),null),a})()}function M(l){const v={accent:"bg-accent-light",success:"bg-success-light",warning:"bg-warning-light",info:"bg-info-light",error:"bg-error-light"},u={accent:"text-accent",success:"text-success",warning:"text-warning",info:"text-info",error:"text-error"};return n(A,{variant:"elevated",padding:"md",get children(){var x=at(),g=x.firstChild,h=g.firstChild,z=h.firstChild,P=g.nextSibling,S=P.firstChild,E=S.nextSibling;return r(S,()=>l.value),r(E,()=>l.label),R(a=>{var t=`w-10 h-10 rounded-xl flex items-center justify-center ${v[l.color]}`,e=`w-5 h-5 ${u[l.color]}`,s=l.icon;return t!==a.e&&G(g,a.e=t),e!==a.t&&O(h,"class",a.t=e),s!==a.a&&O(z,"d",a.a=s),a},{e:void 0,t:void 0,a:void 0}),x}})}function k(l){return(()=>{var v=st(),u=v.firstChild,x=u.firstChild,g=x.nextSibling,h=g.firstChild;return r(x,()=>l.label),r(g,()=>(l.value*100).toFixed(0),h),r(v,n(D,{get value(){return l.value*100},max:100,size:"sm",get color(){return l.color}}),null),v})()}export{vt as default};
