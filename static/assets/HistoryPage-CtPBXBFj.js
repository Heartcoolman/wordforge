import{b as f,o as B,i as n,c as a,S as u,F as I,C as k,B as A,d as E,f as T,t as o}from"./index-6s_4JTtF.js";import{B as j}from"./Badge-k5WGClrt.js";import{E as z}from"./Empty-ceooNyMm.js";import{r as F}from"./records-C70kufFG.js";import{w as H}from"./words-Cj2cVitv.js";import{b as P,c as R}from"./formatters-DIeyM1Gq.js";var D=o("<div class=space-y-2>"),L=o("<div class=text-center>"),O=o('<div class="space-y-6 animate-fade-in-up"><h1 class="text-2xl font-bold text-content">学习历史'),W=o('<div class="flex justify-center py-12">'),q=o('<p class="text-xs text-content-secondary">'),G=o('<div class="flex items-center gap-3"><div><p class="font-medium text-content">'),J=o('<div class="text-right text-xs text-content-tertiary"><p></p><p>');function Y(){const[p,g]=f([]),[h,_]=f({}),[$,x]=f(!0),[y,C]=f(0),[M,S]=f(!0),m=30;async function v(l=!1){l||x(!0);try{const r=await F.list({limit:m,offset:y()})??[];g(l?t=>[...t,...r]:r),S(r.length===m);const c=h(),s=[...new Set(r.map(t=>t.wordId).filter(t=>!c[t]))];if(s.length>0)try{const t=await Promise.allSettled(s.map(i=>H.get(i))),d={...c};for(let i=0;i<t.length;i++){const w=t[i];w.status==="fulfilled"&&(d[s[i]]=w.value)}_(d)}catch{}}catch(e){T.toast.error("加载失败",e instanceof Error?e.message:"")}finally{x(!1)}}B(()=>v());function b(){C(l=>l+m),v(!0)}return(()=>{var l=O();return l.firstChild,n(l,a(u,{get when(){return!$()},get fallback(){return(()=>{var e=W();return n(e,a(E,{size:"lg"})),e})()},get children(){return a(u,{get when(){return p().length>0},get fallback(){return a(z,{title:"暂无学习记录",description:"开始学习后记录将显示在这里"})},get children(){return[(()=>{var e=D();return n(e,a(I,{get each(){return p()},children:r=>{const c=()=>h()[r.wordId];return a(k,{variant:"outlined",padding:"sm",class:"flex items-center justify-between",get children(){return[(()=>{var s=G(),t=s.firstChild,d=t.firstChild;return n(s,a(j,{get variant(){return r.isCorrect?"success":"error"},size:"sm",get children(){return r.isCorrect?"正确":"错误"}}),t),n(d,()=>c()?.text??r.wordId),n(t,a(u,{get when(){return c()},get children(){var i=q();return n(i,()=>c().meaning),i}}),null),s})(),(()=>{var s=J(),t=s.firstChild,d=t.nextSibling;return n(t,()=>P(r.responseTimeMs)),n(d,()=>R(r.createdAt)),s})()]}})}})),e})(),a(u,{get when(){return M()},get children(){var e=L();return n(e,a(A,{variant:"ghost",onClick:b,children:"加载更多"})),e}})]}})}}),null),l})()}export{Y as default};
