import{q as f,b as u,o as T,i as n,c as t,B as w,S as h,F as W,d as U,f as b,C as A,t as c}from"./index-6s_4JTtF.js";import{B as z}from"./Badge-k5WGClrt.js";import{M as F}from"./Modal-BkEW8yGb.js";import{I as E}from"./Input-DbQWqGqX.js";import{E as P}from"./Empty-ceooNyMm.js";import{s as j}from"./studyConfig-Ege34ClO.js";const x={getSystem(){return f.get("/api/wordbooks/system")},getUser(){return f.get("/api/wordbooks/user")},create(s){return f.post("/api/wordbooks",s)},getWords(s,a){return f.get(`/api/wordbooks/${s}/words`,a)},addWords(s,a){return f.post(`/api/wordbooks/${s}/words`,{wordIds:a})},removeWord(s,a){return f.delete(`/api/wordbooks/${s}/words/${a}`)}};var q=c('<p class="text-sm text-content-secondary mt-1">'),D=c('<div class="flex items-start justify-between"><div><h3 class="font-semibold text-content">'),G=c('<div class="flex items-center gap-3 mt-3 text-xs text-content-tertiary"><span> 个单词'),L=c('<div><h2 class="text-lg font-semibold text-content mb-3">系统词书</h2><div class="grid sm:grid-cols-2 gap-3">'),N=c('<div class="grid sm:grid-cols-2 gap-3">'),R=c('<div><h2 class="text-lg font-semibold text-content mb-3">我的词书'),H=c('<p class="text-sm text-content-secondary">已选择 <!> 本词书用于学习'),J=c('<div class="space-y-6 animate-fade-in-up"><div class="flex items-center justify-between"><h1 class="text-2xl font-bold text-content">词书管理'),K=c('<div class="flex justify-center py-12">'),O=c('<div class="space-y-3 mt-2"><div class="flex justify-end gap-2 pt-2">');function re(){const[s,a]=u([]),[p,k]=u([]),[m,v]=u([]),[$,C]=u(!0),[d,g]=u(!1),[y,S]=u(!1);async function B(){C(!0);try{const[r,l,e]=await Promise.all([x.getSystem(),x.getUser(),j.get()]);a(r),k(l),v(e.selectedWordbookIds||[])}catch(r){b.toast.error("加载失败",r instanceof Error?r.message:"")}finally{C(!1)}}T(B);async function M(r){const l=m(),e=l.includes(r)?l.filter(o=>o!==r):[...l,r];v(e),S(!0);try{await j.update({selectedWordbookIds:e}),b.toast.success("词书配置已更新")}catch{v(l),b.toast.error("更新失败")}finally{S(!1)}}function I(r){const l=()=>m().includes(r.book.id);return t(A,{get variant(){return l()?"filled":"outlined"},hover:!0,padding:"md",onClick:()=>M(r.book.id),get class(){return l()?"ring-2 ring-accent":""},get children(){return[(()=>{var e=D(),o=e.firstChild,i=o.firstChild;return n(i,()=>r.book.name),n(o,t(h,{get when(){return r.book.description},get children(){var _=q();return n(_,()=>r.book.description),_}}),null),n(e,t(z,{get variant(){return r.book.bookType==="System"?"info":"accent"},size:"sm",get children(){return r.book.bookType==="System"?"系统":"自定义"}}),null),e})(),(()=>{var e=G(),o=e.firstChild,i=o.firstChild;return n(o,()=>r.book.wordCount,i),n(e,t(h,{get when(){return l()},get children(){return t(z,{variant:"success",size:"sm",children:"已选"})}}),null),e})()]}})}return(()=>{var r=J(),l=r.firstChild;return l.firstChild,n(l,t(w,{onClick:()=>g(!0),size:"sm",children:"创建词书"}),null),n(r,t(h,{get when(){return!$()},get fallback(){return(()=>{var e=K();return n(e,t(U,{size:"lg"})),e})()},get children(){return[t(h,{get when(){return s().length>0},get children(){var e=L(),o=e.firstChild,i=o.nextSibling;return n(i,t(W,{get each(){return s()},children:_=>t(I,{book:_})})),e}}),(()=>{var e=R();return e.firstChild,n(e,t(h,{get when(){return p().length>0},get fallback(){return t(P,{title:"还没有自定义词书",description:"创建自己的词书来组织单词",get action(){return t(w,{onClick:()=>g(!0),size:"sm",children:"创建词书"})}})},get children(){var o=N();return n(o,t(W,{get each(){return p()},children:i=>t(I,{book:i})})),o}}),null),e})(),t(h,{get when(){return m().length>0},get children(){var e=H(),o=e.firstChild,i=o.nextSibling;return i.nextSibling,n(e,()=>m().length,i),e}})]}}),null),n(r,t(Q,{get open(){return d()},onClose:()=>g(!1),onCreated:B}),null),r})()}function Q(s){const[a,p]=u(""),[k,m]=u(""),[v,$]=u(!1);async function C(){if(!a().trim()){b.toast.warning("请输入词书名称");return}$(!0);try{await x.create({name:a().trim(),description:k().trim()||void 0}),b.toast.success("词书已创建"),p(""),m(""),s.onCreated(),s.onClose()}catch(d){b.toast.error("创建失败",d instanceof Error?d.message:"")}finally{$(!1)}}return t(F,{get open(){return s.open},get onClose(){return s.onClose},title:"创建词书",get children(){var d=O(),g=d.firstChild;return n(d,t(E,{label:"名称",get value(){return a()},onInput:y=>p(y.currentTarget.value),placeholder:"例: GRE 核心词汇"}),g),n(d,t(E,{label:"描述",get value(){return k()},onInput:y=>m(y.currentTarget.value),placeholder:"可选"}),g),n(g,t(w,{variant:"ghost",get onClick(){return s.onClose},children:"取消"}),null),n(g,t(w,{onClick:C,get loading(){return v()},children:"创建"}),null),d}})}export{re as default};
