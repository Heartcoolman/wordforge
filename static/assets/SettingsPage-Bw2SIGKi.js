import{i as s,c as l,S as C,e as M,l as p,n as w,s as W,t as c,p as z,b as m,o as j,C as B,B as E,d as F,f as b}from"./index-6s_4JTtF.js";import{I as _}from"./Input-DbQWqGqX.js";import{a as S}from"./admin-Dg2dsvo0.js";var L=c('<span class="text-sm text-content">'),N=c("<label><button type=button role=switch><span>");function T(a){return(()=>{var o=N(),d=o.firstChild,y=d.firstChild;return d.$$click=()=>a.onChange(!a.checked),s(o,l(C,{get when(){return a.label},get children(){var t=L();return s(t,()=>a.label),t}}),null),M(t=>{var h=p("inline-flex items-center gap-2.5 cursor-pointer",a.disabled&&"opacity-50 pointer-events-none",a.class),g=a.checked,v=p("relative inline-flex h-6 w-10 items-center rounded-full transition-colors duration-200",a.checked?"bg-accent":"bg-surface-tertiary"),f=p("inline-block h-4 w-4 rounded-full bg-white shadow-sm transition-transform duration-200",a.checked?"translate-x-5":"translate-x-1");return h!==t.e&&w(o,t.e=h),g!==t.t&&W(d,"aria-checked",t.t=g),v!==t.a&&w(d,t.a=v),f!==t.o&&w(y,t.o=f),t},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()}z(["click"]);var P=c('<h2 class="text-lg font-semibold text-content mb-4">广播消息'),R=c('<div class=space-y-3><div class="flex flex-col gap-1.5"><label class="text-sm font-medium text-content-secondary">内容</label><textarea class="w-full px-3 py-2 rounded-lg text-sm bg-surface text-content border border-border focus:outline-none focus:ring-2 focus:ring-accent/30 focus:border-accent resize-y min-h-[80px]"placeholder=通知内容>'),q=c('<div class="space-y-6 animate-fade-in-up"><h1 class="text-2xl font-bold text-content">系统设置'),G=c('<div class="flex justify-center py-12">'),H=c('<h2 class="text-lg font-semibold text-content mb-4">基本设置'),J=c("<div class=space-y-4><div class=pt-2>");function V(){const[a,o]=m(null),[d,y]=m(!0),[t,h]=m(!1),[g,v]=m(""),[f,k]=m(""),[A,I]=m(!1);j(async()=>{try{const e=await S.getSettings();o(e)}catch{}y(!1)});async function D(){if(a()){h(!0);try{await S.updateSettings(a()),b.toast.success("设置已保存")}catch(e){b.toast.error("保存失败",e instanceof Error?e.message:"")}finally{h(!1)}}}async function U(){if(!g().trim()||!f().trim()){b.toast.warning("请填写标题和内容");return}I(!0);try{const e=await S.broadcast({title:g(),message:f()});b.toast.success(`已发送给 ${e.sent} 位用户`),v(""),k("")}catch(e){b.toast.error("发送失败",e instanceof Error?e.message:"")}finally{I(!1)}}function x(e,n){o(r=>r&&{...r,[e]:n})}return(()=>{var e=q();return e.firstChild,s(e,l(C,{get when(){return!d()},get fallback(){return(()=>{var n=G();return s(n,l(F,{size:"lg"})),n})()},get children(){return[l(C,{get when(){return a()},children:n=>l(B,{variant:"elevated",get children(){return[H(),(()=>{var r=J(),u=r.firstChild;return s(r,l(_,{label:"最大用户数",type:"number",get value(){return String(n().maxUsers)},onInput:i=>x("maxUsers",parseInt(i.currentTarget.value)||0)}),u),s(r,l(_,{label:"默认每日单词数",type:"number",get value(){return String(n().defaultDailyWords)},onInput:i=>x("defaultDailyWords",parseInt(i.currentTarget.value)||20)}),u),s(r,l(T,{get checked(){return n().registrationEnabled},onChange:i=>x("registrationEnabled",i),label:"开放注册"}),u),s(r,l(T,{get checked(){return n().maintenanceMode},onChange:i=>x("maintenanceMode",i),label:"维护模式"}),u),s(u,l(E,{onClick:D,get loading(){return t()},children:"保存设置"})),r})()]}})}),l(B,{variant:"elevated",get children(){return[P(),(()=>{var n=R(),r=n.firstChild,u=r.firstChild,i=u.nextSibling;return s(n,l(_,{label:"标题",get value(){return g()},onInput:$=>v($.currentTarget.value),placeholder:"通知标题"}),r),i.$$input=$=>k($.currentTarget.value),s(n,l(E,{onClick:U,get loading(){return A()},variant:"warning",children:"发送广播"}),null),M(()=>i.value=f()),n})()]}})]}}),null),e})()}z(["input"]);export{V as default};
